<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Closing Coalition â€“ Exam</title>

<style>
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background:#0b1220;
  color:#eaf2ff;
  padding:20px;
}
.card{
  max-width:900px;
  margin:auto;
  background:rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.1);
  border-radius:16px;
  padding:16px;
}
.row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
input{
  padding:10px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,.2);
  background:#00000055;
  color:#eaf2ff;
}
button{
  padding:10px 14px;
  border-radius:10px;
  border:none;
  background:#2dd4bf;
  font-weight:800;
  cursor:pointer;
}
button:disabled{opacity:.5;cursor:not-allowed}
#question{font-size:20px;font-weight:800;margin:16px 0}
.choice{
  padding:10px;
  border:1px solid rgba(255,255,255,.2);
  border-radius:10px;
  margin-bottom:8px;
  cursor:pointer;
}
.choice:hover{background:rgba(255,255,255,.08)}
.choice.selected{outline:3px solid #2dd4bf}
#status{margin-top:10px;font-weight:800}
</style>

<!-- ðŸ”¹ LOAD QUESTION BANK -->
<script src="miexam.js"></script>
</head>

<body>
<div class="card">

  <h2>Practice Exam</h2>

  <div class="row">
    <label># Questions:</label>
    <input id="qCount" type="number" min="1" value="25" />
    <span id="loadedInfo">Loaded: 0</span>
    <button id="startBtn">Start</button>
  </div>

  <div id="exam" style="display:none">
    <div id="counter"></div>
    <div id="question"></div>
    <div id="choices"></div>
    <button id="submitBtn" disabled>Submit</button>
    <button id="nextBtn" disabled>Next</button>
    <div id="status"></div>
  </div>

</div>

<script>
/* ---------- BASIC EXAM ENGINE ---------- */

const allQuestions = Array.isArray(window.MI_EXAM_QUESTIONS)
  ? window.MI_EXAM_QUESTIONS
  : [];

const $ = id => document.getElementById(id);
$("loadedInfo").textContent = `Loaded: ${allQuestions.length}`;

let deck=[], index=0, selected=null, correct=0;

function shuffle(arr){
  return arr.slice().sort(()=>Math.random()-0.5);
}

$("startBtn").onclick = () => {
  const n = Math.min(
    Number($("qCount").value || 0),
    allQuestions.length
  );
  if(!n){ alert("No questions loaded"); return; }

  deck = shuffle(allQuestions).slice(0,n);
  index=0; correct=0;
  $("exam").style.display="block";
  render();
};

function render(){
  const q = deck[index];
  $("counter").textContent = `Question ${index+1}/${deck.length}`;
  $("question").textContent = q.question;
  $("choices").innerHTML="";
  $("status").textContent="";
  selected=null;
  $("submitBtn").disabled=true;
  $("nextBtn").disabled=true;

  shuffle([q.correct,...q.wrongs]).forEach(opt=>{
    const d=document.createElement("div");
    d.className="choice";
    d.textContent=opt;
    d.onclick=()=>{
      selected=opt;
      document.querySelectorAll(".choice").forEach(c=>c.classList.remove("selected"));
      d.classList.add("selected");
      $("submitBtn").disabled=false;
    };
    $("choices").appendChild(d);
  });
}

$("submitBtn").onclick = () => {
  const q = deck[index];
  if(selected===q.correct){
    correct++;
    $("status").textContent="Correct";
  } else {
    $("status").textContent=`Wrong â€” ${q.correct}`;
  }
  $("submitBtn").disabled=true;
  $("nextBtn").disabled=false;
};

$("nextBtn").onclick = () => {
  index++;
  if(index>=deck.length){
    $("exam").innerHTML =
      `<h3>Finished</h3>
       <div>Score: ${correct}/${deck.length}</div>`;
  } else render();
};
</script>
</body>
</html>
